{"ast":null,"code":"import React,{useEffect,useState}from'react';import{twist}from'../../http/userAPi';import cls from'./style.module.css';import Modal from'../../Modal/modal';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const tg=window.Telegram.WebApp;function Wheel(){const[vis,setVis]=useState(false);const[prise,setPrise]=useState(0);const[time,setTime]=useState(0);const[animation,setAnimation]=useState('');const smallPrise=4;const mediumPrise=20;const bigPrise=50;const prises=[mediumPrise,smallPrise,smallPrise,smallPrise,smallPrise,mediumPrise,bigPrise,smallPrise];useEffect(()=>{setTimeout(()=>{if(time<24*3600){setTime(el=>el+1);}},1000);},[time]);const handleSpin=async()=>{var _tg$initDataUnsafe,_tg$initDataUnsafe$us;const data=await twist(tg===null||tg===void 0?void 0:(_tg$initDataUnsafe=tg.initDataUnsafe)===null||_tg$initDataUnsafe===void 0?void 0:(_tg$initDataUnsafe$us=_tg$initDataUnsafe.user)===null||_tg$initDataUnsafe$us===void 0?void 0:_tg$initDataUnsafe$us.id);setTime(data.time);const requiredPrize=data.prise;const getRandomIndexForPrize=(prises,requiredPrize)=>{const matchingIndices=prises.reduce((acc,prise,index)=>{if(prise===requiredPrize){acc.push(index);}return acc;},[]);const randomIndex=matchingIndices[Math.floor(Math.random()*matchingIndices.length)];return randomIndex;};const randomIndex=getRandomIndexForPrize(prises,requiredPrize);const segmentAngle=45;const targetRotation=360*5+randomIndex*segmentAngle;const styleSheet=document.styleSheets[0];const keyframes=\"\\n      @keyframes spin {\\n        0% {\\n          transform: rotate(0deg);\\n        }\\n          10% {\\n          transform: rotate(-30deg);\\n          }\\n\\n          80% {\\n            transform: rotate(\".concat(targetRotation,\"deg);\\n          }\\n          100% {\\n          transform: rotate(\").concat(targetRotation,\"deg);\\n          }\\n      }\\n    \");if(styleSheet.cssRules.length>0){styleSheet.deleteRule(0);}styleSheet.insertRule(keyframes,styleSheet.cssRules.length);setAnimation(\"spin 5s ease-in-out\");setTimeout(()=>{setVis(true);setTimeout(()=>{setPrise(prises[randomIndex]);setAnimation('');console.log(prises[randomIndex]);},100);},4900);};function getParseTime(time){const hCount=Math.floor(time/3600);const mCount=Math.floor(time%3600/60);const sCount=Math.floor(time%60);const h=hCount>9?hCount:\"0\".concat(hCount);const m=mCount>9?mCount:\"0\".concat(mCount);const s=sCount>9?sCount:\"0\".concat(sCount);return\"\".concat(h,\":\").concat(m,\":\").concat(s);}function getProccent(){return time/(3600*24/100);}function modalClose(){setTime(0);setTimeout(()=>{setVis(false);},2500);}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:cls.container,children:[/*#__PURE__*/_jsx(\"img\",{className:cls.arrow,src:\"assets/images/arrow.png\",alt:\"arrow\"}),/*#__PURE__*/_jsx(\"img\",{className:cls.wheel,style:{animation:animation},src:\"assets/images/wheel.png\",alt:\"wheel\"})]}),\" \",time>=24*3600?/*#__PURE__*/_jsx(\"button\",{className:cls.button,onClick:handleSpin,children:\"\\u0412\\u044B\\u0438\\u0433\\u0440\\u044B\\u0432\\u0430\\u0442\\u044C\"}):/*#__PURE__*/_jsx(\"button\",{className:cls.buttonAwait,style:{background:\"linear-gradient(90deg, #008aff \".concat(getProccent(),\"%, #fff \").concat(getProccent(),\"%)\")},children:getParseTime(24*3600-time)}),/*#__PURE__*/_jsx(Modal,{vis:vis,setVis:modalClose,coins:prise})]});}export default Wheel;","map":{"version":3,"names":["React","useEffect","useState","twist","cls","Modal","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","tg","window","Telegram","WebApp","Wheel","vis","setVis","prise","setPrise","time","setTime","animation","setAnimation","smallPrise","mediumPrise","bigPrise","prises","setTimeout","el","handleSpin","_tg$initDataUnsafe","_tg$initDataUnsafe$us","data","initDataUnsafe","user","id","requiredPrize","getRandomIndexForPrize","matchingIndices","reduce","acc","index","push","randomIndex","Math","floor","random","length","segmentAngle","targetRotation","styleSheet","document","styleSheets","keyframes","concat","cssRules","deleteRule","insertRule","console","log","getParseTime","hCount","mCount","sCount","h","m","s","getProccent","modalClose","children","className","container","arrow","src","alt","wheel","style","button","onClick","buttonAwait","background","coins"],"sources":["C:/Users/user/Desktop/Новая папка (2)/game-solutions/src/components/Wheel/MainPage/Wheel/Wheel.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { twist } from '../../http/userAPi';\r\nimport cls from './style.module.css';\r\nimport Modal from '../../Modal/modal';\r\n\r\nconst tg = window.Telegram.WebApp;\r\n\r\nfunction Wheel() {\r\n  const [vis, setVis] = useState(false);\r\n  const [prise, setPrise] = useState(0);\r\n  const [time, setTime] = useState(0);\r\n  const [animation, setAnimation] = useState('');\r\n  const smallPrise = 4;\r\n  const mediumPrise = 20;\r\n  const bigPrise = 50;\r\n\r\n  const prises = [\r\n    mediumPrise,\r\n    smallPrise,\r\n    smallPrise,\r\n    smallPrise,\r\n    smallPrise,\r\n    mediumPrise,\r\n    bigPrise,\r\n    smallPrise,\r\n    \r\n  ];\r\n\r\n  useEffect(() => {\r\n    setTimeout(() => {\r\n      if(time < 24 * 3600) {\r\n        setTime(el => el+1);\r\n        \r\n      }\r\n    }, 1000);\r\n  }, [time])\r\n\r\n  const handleSpin = async () => {\r\n\r\n    const data = await twist(tg?.initDataUnsafe?.user?.id);\r\n\r\n    setTime(data.time);\r\n    const requiredPrize = data.prise; \r\n\r\n    const getRandomIndexForPrize = (prises, requiredPrize) => {\r\n\r\n      const matchingIndices = prises.reduce((acc, prise, index) => {\r\n        if (prise === requiredPrize) {\r\n          acc.push(index);\r\n        }\r\n        return acc;\r\n      }, []);\r\n\r\n      const randomIndex = matchingIndices[Math.floor(Math.random() * matchingIndices.length)];\r\n    \r\n      return randomIndex;\r\n    };\r\n\r\n    const randomIndex = getRandomIndexForPrize(prises, requiredPrize);\r\n\r\n    const segmentAngle = 45;\r\n    const targetRotation = 360 * 5 + (randomIndex) * segmentAngle; \r\n  \r\n\r\n    const styleSheet = document.styleSheets[0];\r\n    const keyframes = `\r\n      @keyframes spin {\r\n        0% {\r\n          transform: rotate(0deg);\r\n        }\r\n          10% {\r\n          transform: rotate(-30deg);\r\n          }\r\n\r\n          80% {\r\n            transform: rotate(${targetRotation}deg);\r\n          }\r\n          100% {\r\n          transform: rotate(${targetRotation}deg);\r\n          }\r\n      }\r\n    `;\r\n\r\n    if (styleSheet.cssRules.length > 0) {\r\n      styleSheet.deleteRule(0);\r\n    }\r\n\r\n    styleSheet.insertRule(keyframes, styleSheet.cssRules.length);\r\n\r\n    setAnimation(`spin 5s ease-in-out`);\r\n\r\n    setTimeout(() => {\r\n      setVis(true);\r\n      setTimeout(() => {\r\n        setPrise(prises[randomIndex]);\r\n        setAnimation('');\r\n        console.log(prises[randomIndex]);\r\n      }, 100)\r\n\r\n    }, 4900);\r\n  };\r\n\r\n  function getParseTime(time) {\r\n    const hCount = Math.floor(time / 3600);\r\n    const mCount = Math.floor((time % 3600) / 60);\r\n    const sCount = Math.floor(time % 60);\r\n\r\n    const h = hCount > 9 ? hCount : `0${hCount}`;\r\n    const m = mCount > 9 ? mCount : `0${mCount}`;\r\n    const s = sCount > 9 ? sCount : `0${sCount}`;\r\n    return `${h}:${m}:${s}`;\r\n  }\r\n\r\n  function getProccent() {\r\n    return time / (3600 * 24 / 100);\r\n  }\r\n\r\n  function modalClose() {\r\n    setTime(0);\r\n    setTimeout(() => {\r\n      setVis(false);\r\n    }, 2500)\r\n    \r\n  }\r\n\r\n  return (\r\n    <>\r\n      <div className={cls.container}>\r\n        <img className={cls.arrow} src='assets/images/arrow.png' alt='arrow' />\r\n        <img\r\n          className={cls.wheel}\r\n          style={{ animation: animation }}\r\n          src='assets/images/wheel.png'\r\n          alt='wheel'\r\n        />\r\n      </div> {\r\n        time >= 24 * 3600 ?\r\n        <button className={cls.button} onClick={handleSpin}>Выигрывать</button> :\r\n        <button className={cls.buttonAwait} style={{background: `linear-gradient(90deg, #008aff ${getProccent()}%, #fff ${getProccent()}%)`}}>{getParseTime(24 * 3600 - time)}</button>\r\n      }\r\n      \r\n      <Modal vis={vis} setVis={modalClose} coins={prise}></Modal>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Wheel;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}